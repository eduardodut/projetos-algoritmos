---
title: "R Notebook"
output: html_notebook
---

Atividades da 1a entrega:

a) Realizar a leitura do arquivo de entrada, armazenando os dados dos contratos (0,5 ponto):
    1. Em um vetor de objetos do tipo contrato; e
    2. Em uma matriz, indexada pelo fornecedor, pelo mês de início e pelo mês de fim do contrato, onde cada elemento armazena o valor do contrato respectivo.

    
```{r message=FALSE, warning=FALSE}
start_time <- Sys.time()
library(magrittr)
library(readr)

parametro <- read.table(
  file = "Dados/entrada.txt",
  header = FALSE,
  nrows = 1,
  col.names = c("n", "m", "t")
)
attach(parametro)

entrada_matricial <- array(dim = c(m, #número do fornecedor
                                   n, #mês_inicial
                                   n))#mês_final


arquivo_em_linhas <-
  read_lines(
    file = "Dados/entrada.txt",
    skip = 0,
    skip_empty_rows = FALSE,
    n_max = -1L,
    locale = default_locale(),
    na = character(),
    progress = show_progress()
  )

i = 0
for (i in 2:length(arquivo_em_linhas)) {
  dados =  strsplit(arquivo_em_linhas[i], " ")[[1]]
  empresa = strtoi(dados[1])
  mes_inicial = strtoi(dados[2])
  mes_final = strtoi(dados[3])
  valor = as.double(dados[4])
  
  entrada_matricial[empresa, mes_inicial, mes_final] = valor
  
}


entrada_vetorizada <- read_table2(
  "Dados/entrada.txt",
  col_names = c("fornecedor", "mes_inicial", "mes_final", "valor"),
  col_types = cols(
    fornecedor = col_integer(),
    mes_inicial = col_integer(),
    mes_final = col_integer()
  ),
  skip = 1
)
#%>% dplyr::mutate(duracao = mes_final - mes_inicial + 1)


entrada_vetorizada <-
  entrada_vetorizada[, c("fornecedor", "mes_inicial",  "mes_final",  "valor")] %>%  as.matrix()

end_time <- Sys.time()

end_time - start_time
```

```{r}
entrada_matricial[1,2,2]
```


```{r}
#denso
n_posicoes_entrada_vetorizada = 4*        #o número de dados por contrato (empresa, mês inicial, mês final e valor) 
                                m*        #numéro de empresas
                                n*(n+1)/2 # soma da progressão aritmética dos contratos por empresas

#esparso
n_posicões_entrada_matricial = m*        #numéro de empresas
                                n*(n+n)/2# m*n^2 ou, a soma de 120 até 120, (ao invés de 120 até 1, pois a posição é alocada mesmo que não haja contrato para ocupá-la)

n_posicoes_entrada_vetorizada
n_posicões_entrada_matricial
```


b) Explicar qual das duas maneiras de armazenamento dos dados é mais eficiente, em relação ao consumo de memória, tanto em termos assintóticos quanto em termos de valores absolutos. (0,5 ponto)
c) Implementar o método de ordenação Insertion Sort para ordenar o vetor de objetos do tipo contrato. Criar um clone do vetor e aplicar o método de ordenação, exibindo ao final o tempo total de execução da ordenação. (1,0 ponto)

```{r}
insertion_sort <- function(A){
     
  for (i in 2:dim(A)[1]) {
    key <- A[i,] 

    j <- i - 1 
    while (i > 0 && A[i,"valor"] > key["valor"]) {
      A[(j + 1),] <- A[j,]
    
      j = j - 1 
    }
    A[(j + 1),] = key
  }
  A
} 
amostras <- sample(1:72600,100)
start_time <- Sys.time()


saida <- insertion_sort(entrada_vetorizada[amostras,])
end_time <- Sys.time()

duracao_insertion_sort <- end_time - start_time
duracao_insertion_sort
```
```{r}
entrada_vetorizada[1,]
```


d) Apresentar a complexidade da função descrita no item anterior, fazendo uso de notação assintótica e tendo como parâmetros somente a quantidade n de meses e a quantidade m de fornecedores. (0,5 ponto)
e) Implementar o método de ordenação Mergesort para ordenar o vetor de objetos do tipo contrato. Criar um clone do vetor e aplicar o método de ordenação, exibindo ao final o tempo total de execução da ordenação. (1,0 ponto)
f) Apresentar a complexidade da função descrita no item anterior, fazendo uso de notação assintótica e tendo como parâmetros somente a quantidade n de meses e a quantidade m de fornecedores. (0,5 ponto)
g) Implementar o método de ordenação Heapsort para ordenar o vetor de objetos do tipo contrato. Criar um clone do vetor e aplicar o método de ordenação, exibindo ao final o tempo total de execução da ordenação. (1,0 ponto)
h) Apresentar a complexidade da função descrita no item anterior, fazendo uso de notação assintótica e tendo como parâmetros somente a quantidade n de meses e a quantidade m de fornecedores. (0,5 ponto)
i) Implementar o método de ordenação Quicksort para ordenar o vetor de objetos do tipo contrato. Criar um clone do vetor e aplicar o método de ordenação, exibindo ao final o tempo total de execução da ordenação. (1,0 ponto)
j) Apresentar a complexidade da função descrita no item anterior, fazendo uso de notação assintótica e tendo como parâmetros somente a quantidade n de meses e a quantidade m de fornecedores. (0,5 ponto)
k) Baseando-se nas ideias dos algoritmos apresentados, criar um método de ordenação que, entretanto, explore as regras de formação de preços de contratos de um fornecedor (expressas na matriz de contratos), para realizar a ordenação dos contratos pelo valor, exibindo ao final o tempo total de execução da ordenação. (2,0 pontos)
l) Apresentar a complexidade da função descrita no item anterior, fazendo uso de notação assintótica e tendo como parâmetros somente a quantidade n de meses e a quantidade m de fornecedores. (1,0 ponto)



```{r}


```

